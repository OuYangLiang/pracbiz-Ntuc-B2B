<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.pracbiz.b2bportal.core.mapper.DnHeaderMapper" >
  <resultMap id="BaseResultMap" type="com.pracbiz.b2bportal.core.holder.DnHeaderHolder" >
    <id column="DN_OID" property="dnOid" jdbcType="DECIMAL" />
    <result column="DN_NO" property="dnNo" jdbcType="VARCHAR" />
    <result column="DOC_ACTION" property="docAction" jdbcType="CHAR" />
    <result column="ACTION_DATE" property="actionDate" jdbcType="TIMESTAMP" />
    <result column="DN_TYPE" property="dnType" jdbcType="VARCHAR" />
    <result column="DN_TYPE_DESC" property="dnTypeDesc" jdbcType="VARCHAR" />
    <result column="DN_DATE" property="dnDate" jdbcType="DATE" />
    <result column="PO_NO" property="poNo" jdbcType="VARCHAR" />
    <result column="PO_DATE" property="poDate" jdbcType="DATE" />
    <result column="INV_NO" property="invNo" jdbcType="VARCHAR" />
    <result column="INV_DATE" property="invDate" jdbcType="DATE" />
    <result column="RTV_NO" property="rtvNo" jdbcType="VARCHAR" />
    <result column="RTV_DATE" property="rtvDate" jdbcType="DATE" />
    <result column="GI_NO" property="giNo" jdbcType="VARCHAR" />
    <result column="GI_DATE" property="giDate" jdbcType="DATE" />
    <result column="BUYER_OID" property="buyerOid" jdbcType="DECIMAL" />
    <result column="BUYER_CODE" property="buyerCode" jdbcType="VARCHAR" />
    <result column="BUYER_NAME" property="buyerName" jdbcType="VARCHAR" />
    <result column="BUYER_ADDR1" property="buyerAddr1" jdbcType="VARCHAR" />
    <result column="BUYER_ADDR2" property="buyerAddr2" jdbcType="VARCHAR" />
    <result column="BUYER_ADDR3" property="buyerAddr3" jdbcType="VARCHAR" />
    <result column="BUYER_ADDR4" property="buyerAddr4" jdbcType="VARCHAR" />
    <result column="BUYER_CITY" property="buyerCity" jdbcType="VARCHAR" />
    <result column="BUYER_STATE" property="buyerState" jdbcType="VARCHAR" />
    <result column="BUYER_CTRY_CODE" property="buyerCtryCode" jdbcType="CHAR" />
    <result column="BUYER_POSTAL_CODE" property="buyerPostalCode" jdbcType="VARCHAR" />
    <result column="DEPT_CODE" property="deptCode" jdbcType="VARCHAR" />
    <result column="DEPT_NAME" property="deptName" jdbcType="VARCHAR" />
    <result column="SUB_DEPT_CODE" property="subDeptCode" jdbcType="VARCHAR" />
    <result column="SUB_DEPT_NAME" property="subDeptName" jdbcType="VARCHAR" />
    <result column="SUPPLIER_OID" property="supplierOid" jdbcType="DECIMAL" />
    <result column="SUPPLIER_CODE" property="supplierCode" jdbcType="VARCHAR" />
    <result column="SUPPLIER_NAME" property="supplierName" jdbcType="VARCHAR" />
    <result column="SUPPLIER_ADDR1" property="supplierAddr1" jdbcType="VARCHAR" />
    <result column="SUPPLIER_ADDR2" property="supplierAddr2" jdbcType="VARCHAR" />
    <result column="SUPPLIER_ADDR3" property="supplierAddr3" jdbcType="VARCHAR" />
    <result column="SUPPLIER_ADDR4" property="supplierAddr4" jdbcType="VARCHAR" />
    <result column="SUPPLIER_CITY" property="supplierCity" jdbcType="VARCHAR" />
    <result column="SUPPLIER_STATE" property="supplierState" jdbcType="VARCHAR" />
    <result column="SUPPLIER_CTRY_CODE" property="supplierCtryCode" jdbcType="CHAR" />
    <result column="SUPPLIER_POSTAL_CODE" property="supplierPostalCode" jdbcType="VARCHAR" />
    <result column="STORE_CODE" property="storeCode" jdbcType="VARCHAR" />
    <result column="STORE_NAME" property="storeName" jdbcType="VARCHAR" />
    <result column="STORE_ADDR1" property="storeAddr1" jdbcType="VARCHAR" />
    <result column="STORE_ADDR2" property="storeAddr2" jdbcType="VARCHAR" />
    <result column="STORE_ADDR3" property="storeAddr3" jdbcType="VARCHAR" />
    <result column="STORE_ADDR4" property="storeAddr4" jdbcType="CHAR" />
    <result column="STORE_CITY" property="storeCity" jdbcType="VARCHAR" />
    <result column="STORE_STATE" property="storeState" jdbcType="VARCHAR" />
    <result column="STORE_CTRY_CODE" property="storeCtryCode" jdbcType="CHAR" />
    <result column="STORE_POSTAL_CODE" property="storePostalCode" jdbcType="VARCHAR" />
    <result column="TOTAL_COST" property="totalCost" jdbcType="DECIMAL" />
    <result column="TOTAL_VAT" property="totalVat" jdbcType="DECIMAL" />
    <result column="TOTAL_COST_WITH_VAT" property="totalCostWithVat" jdbcType="DECIMAL" />
    <result column="VAT_RATE" property="vatRate" jdbcType="DECIMAL" />
    <result column="REASON_CODE" property="reasonCode" jdbcType="VARCHAR" />
    <result column="REASON_DESC" property="reasonDesc" jdbcType="VARCHAR" />
    <result column="DN_REMARKS" property="dnRemarks" jdbcType="VARCHAR" />
    <result column="SENT_TO_SUPPLIER" property="sentToSupplier" jdbcType="BIT" />
    <result column="MARK_SENT_TO_SUPPLIER" property="markSentToSupplier" jdbcType="BIT" />
    <result column="CTRL_STATUS" property="dnStatus" jdbcType="CHAR" />
    <result column="DUPLICATE" property="duplicate" jdbcType="BIT" />
    <result column="PRICE_STATUS" property="priceStatus" jdbcType="CHAR" />
    <result column="QTY_STATUS" property="qtyStatus" jdbcType="CHAR" />
    <result column="BUYER_STATUS" property="buyerStatus" jdbcType="CHAR" />
    <result column="DISPUTE" property="dispute" jdbcType="BIT" />
    <result column="DISPUTE_BY" property="disputeBy" jdbcType="VARCHAR" />
    <result column="DISPUTE_DATE" property="disputeDate" jdbcType="TIMESTAMP" />
    <result column="EXPORTED" property="exported" jdbcType="BIT" />
    <result column="EXPORTED_DATE" property="exportedDate" jdbcType="TIMESTAMP" />
    <result column="CLOSED" property="closed" jdbcType="BIT" />
    <result column="CLOSED_BY" property="closedBy" jdbcType="VARCHAR" />
    <result column="CLOSED_DATE" property="closedDate" jdbcType="TIMESTAMP" />
    <result column="CLOSED_REMARKS" property="closedRemarks" jdbcType="VARCHAR" />
    <result column="PRICE_DISPUTED" property="priceDisputed" jdbcType="BIT" />
    <result column="QTY_DISPUTED" property="qtyDisputed" jdbcType="BIT" />
  </resultMap>
  
  <sql id="Base_Column_List" >
    DN_OID, DN_NO, DOC_ACTION, ACTION_DATE, DN_TYPE, DN_TYPE_DESC, DN_DATE, PO_NO, PO_DATE, 
    INV_NO, INV_DATE, RTV_NO, RTV_DATE, GI_NO, GI_DATE, BUYER_OID, BUYER_CODE, BUYER_NAME, 
    BUYER_ADDR1, BUYER_ADDR2, BUYER_ADDR3, BUYER_ADDR4, BUYER_CITY, BUYER_STATE, BUYER_CTRY_CODE, 
    BUYER_POSTAL_CODE, DEPT_CODE, DEPT_NAME, SUB_DEPT_CODE, SUB_DEPT_NAME, SUPPLIER_OID, 
    SUPPLIER_CODE, SUPPLIER_NAME, SUPPLIER_ADDR1, SUPPLIER_ADDR2, SUPPLIER_ADDR3, SUPPLIER_ADDR4, 
    SUPPLIER_CITY, SUPPLIER_STATE, SUPPLIER_CTRY_CODE, SUPPLIER_POSTAL_CODE, STORE_CODE, 
    STORE_NAME, STORE_ADDR1, STORE_ADDR2, STORE_ADDR3, STORE_ADDR4, STORE_CITY, STORE_STATE, 
    STORE_CTRY_CODE, STORE_POSTAL_CODE, TOTAL_COST, TOTAL_VAT, TOTAL_COST_WITH_VAT, VAT_RATE, 
    REASON_CODE, REASON_DESC, DN_REMARKS, SENT_TO_SUPPLIER, MARK_SENT_TO_SUPPLIER, CTRL_STATUS, 
    DUPLICATE, PRICE_STATUS, QTY_STATUS, BUYER_STATUS, DISPUTE, DISPUTE_BY, DISPUTE_DATE, 
    EXPORTED, EXPORTED_DATE, CLOSED, CLOSED_BY, CLOSED_DATE, CLOSED_REMARKS, PRICE_DISPUTED, QTY_DISPUTED
  </sql>
  <select id="select" resultMap="BaseResultMap" parameterType="com.pracbiz.b2bportal.core.holder.DnHeaderHolder" >
    select 
    <include refid="Base_Column_List" />
    from DN_HEADER
    <where>
      <if test="dnOid != null" >
        DN_OID = #{dnOid,jdbcType=DECIMAL}
      </if>
      <if test="dnNo != null" >
        and DN_NO = #{dnNo,jdbcType=VARCHAR}
      </if>
      <if test="docAction != null" >
        and DOC_ACTION = #{docAction,jdbcType=CHAR}
      </if>
      <if test="actionDate != null" >
        and ACTION_DATE = #{actionDate,jdbcType=TIMESTAMP}
      </if>
      <if test="dnType != null" >
        and DN_TYPE = #{dnType,jdbcType=VARCHAR}
      </if>
      <if test="dnTypeDesc != null" >
        and DN_TYPE_DESC = #{dnTypeDesc,jdbcType=VARCHAR}
      </if>
      <if test="dnDate != null" >
        and DN_DATE = #{dnDate,jdbcType=DATE}
      </if>
      <if test="poNo != null" >
        and PO_NO = #{poNo,jdbcType=VARCHAR}
      </if>
      <if test="poDate != null" >
        and PO_DATE = #{poDate,jdbcType=DATE}
      </if>
      <if test="invNo != null" >
        and INV_NO = #{invNo,jdbcType=VARCHAR}
      </if>
      <if test="invDate != null" >
        and INV_DATE = #{invDate,jdbcType=DATE}
      </if>
      <if test="rtvNo != null" >
        and RTV_NO = #{rtvNo,jdbcType=VARCHAR}
      </if>
      <if test="rtvDate != null" >
        and RTV_DATE = #{rtvDate,jdbcType=DATE}
      </if>
      <if test="giNo != null" >
        and GI_NO = #{giNo,jdbcType=VARCHAR}
      </if>
      <if test="giDate != null" >
        and GI_DATE = #{giDate,jdbcType=DATE}
      </if>
      <if test="buyerOid != null" >
        and BUYER_OID = #{buyerOid,jdbcType=DECIMAL}
      </if>
      <if test="buyerCode != null" >
        and BUYER_CODE = #{buyerCode,jdbcType=VARCHAR}
      </if>
      <if test="buyerName != null" >
        and BUYER_NAME = #{buyerName,jdbcType=VARCHAR}
      </if>
      <if test="buyerAddr1 != null" >
        and BUYER_ADDR1 = #{buyerAddr1,jdbcType=VARCHAR}
      </if>
      <if test="buyerAddr2 != null" >
        and BUYER_ADDR2 = #{buyerAddr2,jdbcType=VARCHAR}
      </if>
      <if test="buyerAddr3 != null" >
        and BUYER_ADDR3 = #{buyerAddr3,jdbcType=VARCHAR}
      </if>
      <if test="buyerAddr4 != null" >
        and BUYER_ADDR4 = #{buyerAddr4,jdbcType=VARCHAR}
      </if>
      <if test="buyerCity != null" >
        and BUYER_CITY = #{buyerCity,jdbcType=VARCHAR}
      </if>
      <if test="buyerState != null" >
        and BUYER_STATE = #{buyerState,jdbcType=VARCHAR}
      </if>
      <if test="buyerCtryCode != null" >
        and BUYER_CTRY_CODE = #{buyerCtryCode,jdbcType=CHAR}
      </if>
      <if test="buyerPostalCode != null" >
        and BUYER_POSTAL_CODE = #{buyerPostalCode,jdbcType=VARCHAR}
      </if>
      <if test="deptCode != null" >
        and DEPT_CODE = #{deptCode,jdbcType=VARCHAR}
      </if>
      <if test="deptName != null" >
        and DEPT_NAME = #{deptName,jdbcType=VARCHAR}
      </if>
      <if test="subDeptCode != null" >
        and SUB_DEPT_CODE = #{subDeptCode,jdbcType=VARCHAR}
      </if>
      <if test="subDeptName != null" >
        and SUB_DEPT_NAME = #{subDeptName,jdbcType=VARCHAR}
      </if>
      <if test="supplierOid != null" >
        and SUPPLIER_OID = #{supplierOid,jdbcType=DECIMAL}
      </if>
      <if test="supplierCode != null" >
        and SUPPLIER_CODE = #{supplierCode,jdbcType=VARCHAR}
      </if>
      <if test="supplierName != null" >
        and SUPPLIER_NAME = #{supplierName,jdbcType=VARCHAR}
      </if>
      <if test="supplierAddr1 != null" >
        and SUPPLIER_ADDR1 = #{supplierAddr1,jdbcType=VARCHAR}
      </if>
      <if test="supplierAddr2 != null" >
        and SUPPLIER_ADDR2 = #{supplierAddr2,jdbcType=VARCHAR}
      </if>
      <if test="supplierAddr3 != null" >
        and SUPPLIER_ADDR3 = #{supplierAddr3,jdbcType=VARCHAR}
      </if>
      <if test="supplierAddr4 != null" >
        and SUPPLIER_ADDR4 = #{supplierAddr4,jdbcType=VARCHAR}
      </if>
      <if test="supplierCity != null" >
        and SUPPLIER_CITY = #{supplierCity,jdbcType=VARCHAR}
      </if>
      <if test="supplierState != null" >
        and SUPPLIER_STATE = #{supplierState,jdbcType=VARCHAR}
      </if>
      <if test="supplierCtryCode != null" >
        and SUPPLIER_CTRY_CODE = #{supplierCtryCode,jdbcType=CHAR}
      </if>
      <if test="supplierPostalCode != null" >
        and SUPPLIER_POSTAL_CODE = #{supplierPostalCode,jdbcType=VARCHAR}
      </if>
      <if test="storeCode != null">
        and STORE_CODE = #{storeCode,jdbcType=VARCHAR}
      </if>
      <if test="storeName != null">
        and STORE_NAME = #{storeName,jdbcType=VARCHAR}
      </if>
      <if test="storeAddr1 != null">
        and STORE_ADDR1 = #{storeAddr1,jdbcType=VARCHAR}
      </if>
      <if test="storeAddr2 != null">
        and STORE_ADDR2 = #{storeAddr2,jdbcType=VARCHAR}
      </if>
      <if test="storeAddr3 != null">
        and STORE_ADDR3 = #{storeAddr3,jdbcType=VARCHAR}
      </if>
      <if test="storeAddr4 != null">
        and STORE_ADDR4 = #{storeAddr4,jdbcType=VARCHAR}
      </if>
      <if test="storeCity != null">
        and STORE_CITY = #{storeCity,jdbcType=VARCHAR}
      </if>
      <if test="storeState != null">
        and STORE_STATE = #{storeState,jdbcType=VARCHAR}
      </if>
      <if test="storeCtryCode != null">
       and  STORE_CTRY_CODE = #{storeCtryCode,jdbcType=CHAR}
      </if>
      <if test="storePostalCode != null">
        and STORE_POSTAL_CODE = #{storePostalCode,jdbcType=VARCHAR}
      </if>
      <if test="totalCost != null" >
        and TOTAL_COST = #{totalCost,jdbcType=DECIMAL}
      </if>
      <if test="totalVat != null" >
        and TOTAL_VAT = #{totalVat,jdbcType=DECIMAL}
      </if>
      <if test="totalCostWithVat != null" >
        and TOTAL_COST_WITH_VAT = #{totalCostWithVat,jdbcType=DECIMAL}
      </if>
      <if test="vatRate != null" >
        and VAT_RATE = #{vatRate,jdbcType=DECIMAL}
      </if>
      <if test="reasonCode != null" >
        and REASON_CODE = #{reasonCode,jdbcType=VARCHAR}
      </if>
      <if test="reasonDesc != null" >
        and REASON_DESC = #{reasonDesc,jdbcType=VARCHAR}
      </if>
      <if test="dnRemarks != null" >
        and DN_REMARKS = #{dnRemarks,jdbcType=VARCHAR}
      </if>
      <if test="sentToSupplier != null" >
        and SENT_TO_SUPPLIER = #{sentToSupplier,jdbcType=BOOLEAN}
      </if>
      <if test="markSentToSupplier != null" >
        and MARK_SENT_TO_SUPPLIER = #{markSentToSupplier,jdbcType=BOOLEAN}
      </if>
	  <if test="dnStatus != null" >
        and CTRL_STATUS = #{dnStatus,jdbcType=VARCHAR}
      </if>
	  <if test="duplicate != null" >
        and DUPLICATE = #{duplicate,jdbcType=BIT}
      </if>
	  <if test="priceStatus != null">
        and PRICE_STATUS = #{priceStatus,jdbcType=CHAR}
      </if>
      <if test="qtyStatus != null">
        and QTY_STATUS = #{qtyStatus,jdbcType=CHAR}
      </if>
      <if test="buyerStatus != null">
        and BUYER_STATUS = #{buyerStatus,jdbcType=CHAR}
      </if>
      <if test="dispute != null">
        and DISPUTE = #{dispute,jdbcType=BIT}
      </if>
      <if test="disputeBy != null">
        and DISPUTE_BY = #{disputeBy,jdbcType=VARCHAR}
      </if>
      <if test="disputeDate != null">
        and DISPUTE_DATE = #{disputeDate,jdbcType=TIMESTAMP}
      </if>
      <if test="exported != null">
        and EXPORTED = #{exported,jdbcType=BIT}
      </if>
      <if test="exportedDate != null">
        and EXPORTED_DATE = #{exportedDate,jdbcType=TIMESTAMP}
      </if>
      <if test="exportedDateFrom != null">
            <![CDATA[
            AND EXPORTED_DATE >= #{exportedDateFrom,jdbcType=TIMESTAMP}
            ]]>
        </if>
        <if test="exportedDateTo != null">
            <![CDATA[
            AND EXPORTED_DATE <= #{exportedDateTo,jdbcType=TIMESTAMP}
            ]]>
        </if>
      <if test="closed != null">
        and CLOSED = #{closed,jdbcType=BIT}
      </if>
      <if test="closedBy != null">
        and CLOSED_BY = #{closedBy,jdbcType=VARCHAR}
      </if>
      <if test="closedDate != null">
        and CLOSED_DATE = #{closedDate,jdbcType=TIMESTAMP}
      </if>
      <if test="closedRemarks != null">
        and CLOSED_REMARKS = #{closedRemarks,jdbcType=VARCHAR}
      </if>
    </where>
  </select>
  <delete id="delete" parameterType="com.pracbiz.b2bportal.core.holder.DnHeaderHolder" >
    delete from DN_HEADER
    <where>
      <if test="dnOid != null" >
        DN_OID = #{dnOid,jdbcType=DECIMAL}
      </if>
      <if test="dnNo != null" >
        and DN_NO = #{dnNo,jdbcType=VARCHAR}
      </if>
      <if test="docAction != null" >
        and DOC_ACTION = #{docAction,jdbcType=CHAR}
      </if>
      <if test="actionDate != null" >
        and ACTION_DATE = #{actionDate,jdbcType=TIMESTAMP}
      </if>
      <if test="dnType != null" >
        and DN_TYPE = #{dnType,jdbcType=VARCHAR}
      </if>
      <if test="dnTypeDesc != null" >
        and DN_TYPE_DESC = #{dnTypeDesc,jdbcType=VARCHAR}
      </if>
      <if test="dnDate != null" >
        and DN_DATE = #{dnDate,jdbcType=DATE}
      </if>
      <if test="poNo != null" >
        and PO_NO = #{poNo,jdbcType=VARCHAR}
      </if>
      <if test="poDate != null" >
        and PO_DATE = #{poDate,jdbcType=DATE}
      </if>
      <if test="invNo != null" >
        and INV_NO = #{invNo,jdbcType=VARCHAR}
      </if>
      <if test="invDate != null" >
        and INV_DATE = #{invDate,jdbcType=DATE}
      </if>
      <if test="rtvNo != null" >
        and RTV_NO = #{rtvNo,jdbcType=VARCHAR}
      </if>
      <if test="rtvDate != null" >
        and RTV_DATE = #{rtvDate,jdbcType=DATE}
      </if>
      <if test="giNo != null" >
        and GI_NO = #{giNo,jdbcType=VARCHAR}
      </if>
      <if test="giDate != null" >
        and GI_DATE = #{giDate,jdbcType=DATE}
      </if>
      <if test="buyerOid != null" >
        and BUYER_OID = #{buyerOid,jdbcType=DECIMAL}
      </if>
      <if test="buyerCode != null" >
        and BUYER_CODE = #{buyerCode,jdbcType=VARCHAR}
      </if>
      <if test="buyerName != null" >
        and BUYER_NAME = #{buyerName,jdbcType=VARCHAR}
      </if>
      <if test="buyerAddr1 != null" >
        and BUYER_ADDR1 = #{buyerAddr1,jdbcType=VARCHAR}
      </if>
      <if test="buyerAddr2 != null" >
        and BUYER_ADDR2 = #{buyerAddr2,jdbcType=VARCHAR}
      </if>
      <if test="buyerAddr3 != null" >
        and BUYER_ADDR3 = #{buyerAddr3,jdbcType=VARCHAR}
      </if>
      <if test="buyerAddr4 != null" >
        and BUYER_ADDR4 = #{buyerAddr4,jdbcType=VARCHAR}
      </if>
      <if test="buyerCity != null" >
        and BUYER_CITY = #{buyerCity,jdbcType=VARCHAR}
      </if>
      <if test="buyerState != null" >
        and BUYER_STATE = #{buyerState,jdbcType=VARCHAR}
      </if>
      <if test="buyerCtryCode != null" >
        and BUYER_CTRY_CODE = #{buyerCtryCode,jdbcType=CHAR}
      </if>
      <if test="buyerPostalCode != null" >
        and BUYER_POSTAL_CODE = #{buyerPostalCode,jdbcType=VARCHAR}
      </if>
      <if test="deptCode != null" >
        and DEPT_CODE = #{deptCode,jdbcType=VARCHAR}
      </if>
      <if test="deptName != null" >
        and DEPT_NAME = #{deptName,jdbcType=VARCHAR}
      </if>
      <if test="subDeptCode != null" >
        and SUB_DEPT_CODE = #{subDeptCode,jdbcType=VARCHAR}
      </if>
      <if test="subDeptName != null" >
        and SUB_DEPT_NAME = #{subDeptName,jdbcType=VARCHAR}
      </if>
      <if test="supplierOid != null" >
        and SUPPLIER_OID = #{supplierOid,jdbcType=DECIMAL}
      </if>
      <if test="supplierCode != null" >
        and SUPPLIER_CODE = #{supplierCode,jdbcType=VARCHAR}
      </if>
      <if test="supplierName != null" >
        and SUPPLIER_NAME = #{supplierName,jdbcType=VARCHAR}
      </if>
      <if test="supplierAddr1 != null" >
        and SUPPLIER_ADDR1 = #{supplierAddr1,jdbcType=VARCHAR}
      </if>
      <if test="supplierAddr2 != null" >
        and SUPPLIER_ADDR2 = #{supplierAddr2,jdbcType=VARCHAR}
      </if>
      <if test="supplierAddr3 != null" >
        and SUPPLIER_ADDR3 = #{supplierAddr3,jdbcType=VARCHAR}
      </if>
      <if test="supplierAddr4 != null" >
        and SUPPLIER_ADDR4 = #{supplierAddr4,jdbcType=VARCHAR}
      </if>
      <if test="supplierCity != null" >
        and SUPPLIER_CITY = #{supplierCity,jdbcType=VARCHAR}
      </if>
      <if test="supplierState != null" >
        and SUPPLIER_STATE = #{supplierState,jdbcType=VARCHAR}
      </if>
      <if test="supplierCtryCode != null" >
        and SUPPLIER_CTRY_CODE = #{supplierCtryCode,jdbcType=CHAR}
      </if>
      <if test="supplierPostalCode != null" >
        and SUPPLIER_POSTAL_CODE = #{supplierPostalCode,jdbcType=VARCHAR}
      </if>
      <if test="storeCode != null">
        and STORE_CODE = #{storeCode,jdbcType=VARCHAR}
      </if>
      <if test="storeName != null">
        and STORE_NAME = #{storeName,jdbcType=VARCHAR}
      </if>
      <if test="storeAddr1 != null">
        and STORE_ADDR1 = #{storeAddr1,jdbcType=VARCHAR}
      </if>
      <if test="storeAddr2 != null">
        and STORE_ADDR2 = #{storeAddr2,jdbcType=VARCHAR}
      </if>
      <if test="storeAddr3 != null">
        and STORE_ADDR3 = #{storeAddr3,jdbcType=VARCHAR}
      </if>
      <if test="storeAddr4 != null">
        and STORE_ADDR4 = #{storeAddr4,jdbcType=VARCHAR}
      </if>
      <if test="storeCity != null">
        and STORE_CITY = #{storeCity,jdbcType=VARCHAR}
      </if>
      <if test="storeState != null">
        and STORE_STATE = #{storeState,jdbcType=VARCHAR}
      </if>
      <if test="storeCtryCode != null">
       and  STORE_CTRY_CODE = #{storeCtryCode,jdbcType=CHAR}
      </if>
      <if test="storePostalCode != null">
        and STORE_POSTAL_CODE = #{storePostalCode,jdbcType=VARCHAR}
      </if>
      <if test="totalCost != null" >
        and TOTAL_COST = #{totalCost,jdbcType=DECIMAL}
      </if>
      <if test="totalVat != null" >
        and TOTAL_VAT = #{totalVat,jdbcType=DECIMAL}
      </if>
      <if test="totalCostWithVat != null" >
        and TOTAL_COST_WITH_VAT = #{totalCostWithVat,jdbcType=DECIMAL}
      </if>
      <if test="vatRate != null" >
        and VAT_RATE = #{vatRate,jdbcType=DECIMAL}
      </if>
      <if test="reasonCode != null" >
        and REASON_CODE = #{reasonCode,jdbcType=VARCHAR}
      </if>
      <if test="reasonDesc != null" >
        and REASON_DESC = #{reasonDesc,jdbcType=VARCHAR}
      </if>
      <if test="dnRemarks != null" >
        and DN_REMARKS = #{dnRemarks,jdbcType=VARCHAR}
      </if>
      <if test="sentToSupplier != null" >
        and SENT_TO_SUPPLIER = #{sentToSupplier,jdbcType=BOOLEAN}
      </if>
      <if test="markSentToSupplier != null" >
        and MARK_SENT_TO_SUPPLIER = #{markSentToSupplier,jdbcType=BOOLEAN}
      </if>
	  <if test="dnStatus != null" >
        and CTRL_STATUS = #{dnStatus,jdbcType=VARCHAR}
      </if>
      <if test="duplicate != null" >
        and DUPLICATE = #{duplicate,jdbcType=BIT}
      </if>
      <if test="priceStatus != null">
        and PRICE_STATUS = #{priceStatus,jdbcType=CHAR}
      </if>
      <if test="qtyStatus != null">
        and QTY_STATUS = #{qtyStatus,jdbcType=CHAR}
      </if>
      <if test="buyerStatus != null">
        and BUYER_STATUS = #{buyerStatus,jdbcType=CHAR}
      </if>
      <if test="dispute != null">
        and DISPUTE = #{dispute,jdbcType=BIT}
      </if>
      <if test="disputeBy != null">
        and DISPUTE_BY = #{disputeBy,jdbcType=VARCHAR}
      </if>
      <if test="disputeDate != null">
        and DISPUTE_DATE = #{disputeDate,jdbcType=TIMESTAMP}
      </if>
      <if test="exported != null">
        and EXPORTED = #{exported,jdbcType=BIT}
      </if>
      <if test="closed != null">
        and CLOSED = #{closed,jdbcType=BIT}
      </if>
      <if test="closedBy != null">
        and CLOSED_BY = #{closedBy,jdbcType=VARCHAR}
      </if>
      <if test="closedDate != null">
        and CLOSED_DATE = #{closedDate,jdbcType=TIMESTAMP}
      </if>
      <if test="closedRemarks != null">
        and CLOSED_REMARKS = #{closedRemarks,jdbcType=VARCHAR}
      </if>
    </where>
  </delete>
  <insert id="insert" parameterType="com.pracbiz.b2bportal.core.holder.DnHeaderHolder" >
    insert into DN_HEADER (DN_OID, DN_NO, DOC_ACTION, 
      ACTION_DATE, DN_TYPE, DN_TYPE_DESC, 
      DN_DATE, PO_NO, PO_DATE, INV_NO, 
      INV_DATE, RTV_NO, RTV_DATE, 
      GI_NO, GI_DATE, BUYER_OID, 
      BUYER_CODE, BUYER_NAME, BUYER_ADDR1, 
      BUYER_ADDR2, BUYER_ADDR3, BUYER_ADDR4, 
      BUYER_CITY, BUYER_STATE, BUYER_CTRY_CODE, 
      BUYER_POSTAL_CODE, DEPT_CODE, DEPT_NAME, 
      SUB_DEPT_CODE, SUB_DEPT_NAME, SUPPLIER_OID, 
      SUPPLIER_CODE, SUPPLIER_NAME, SUPPLIER_ADDR1, 
      SUPPLIER_ADDR2, SUPPLIER_ADDR3, SUPPLIER_ADDR4, 
      SUPPLIER_CITY, SUPPLIER_STATE, SUPPLIER_CTRY_CODE, 
      SUPPLIER_POSTAL_CODE, STORE_CODE, STORE_NAME, 
      STORE_ADDR1, STORE_ADDR2, STORE_ADDR3, 
      STORE_ADDR4, STORE_CITY, STORE_STATE, 
      STORE_CTRY_CODE, STORE_POSTAL_CODE, TOTAL_COST, 
      TOTAL_VAT, TOTAL_COST_WITH_VAT, VAT_RATE, 
      REASON_CODE, REASON_DESC, DN_REMARKS, 
      SENT_TO_SUPPLIER, MARK_SENT_TO_SUPPLIER, CTRL_STATUS, 
      DUPLICATE, PRICE_STATUS, QTY_STATUS, 
      BUYER_STATUS, DISPUTE, DISPUTE_BY, 
      DISPUTE_DATE, EXPORTED, EXPORTED_DATE, CLOSED, 
      CLOSED_BY, CLOSED_DATE, CLOSED_REMARKS, PRICE_DISPUTED, QTY_DISPUTED)
    values (#{dnOid,jdbcType=DECIMAL}, #{dnNo,jdbcType=VARCHAR}, #{docAction,jdbcType=CHAR}, 
      #{actionDate,jdbcType=TIMESTAMP}, #{dnType,jdbcType=VARCHAR}, #{dnTypeDesc,jdbcType=VARCHAR}, 
      #{dnDate,jdbcType=DATE}, #{poNo,jdbcType=VARCHAR}, #{poDate,jdbcType=DATE}, #{invNo,jdbcType=VARCHAR}, 
      #{invDate,jdbcType=DATE}, #{rtvNo,jdbcType=VARCHAR}, #{rtvDate,jdbcType=DATE}, 
      #{giNo,jdbcType=VARCHAR}, #{giDate,jdbcType=DATE}, #{buyerOid,jdbcType=DECIMAL}, 
      #{buyerCode,jdbcType=VARCHAR}, #{buyerName,jdbcType=VARCHAR}, #{buyerAddr1,jdbcType=VARCHAR}, 
      #{buyerAddr2,jdbcType=VARCHAR}, #{buyerAddr3,jdbcType=VARCHAR}, #{buyerAddr4,jdbcType=VARCHAR}, 
      #{buyerCity,jdbcType=VARCHAR}, #{buyerState,jdbcType=VARCHAR}, #{buyerCtryCode,jdbcType=CHAR}, 
      #{buyerPostalCode,jdbcType=VARCHAR}, #{deptCode,jdbcType=VARCHAR}, #{deptName,jdbcType=VARCHAR}, 
      #{subDeptCode,jdbcType=VARCHAR}, #{subDeptName,jdbcType=VARCHAR}, #{supplierOid,jdbcType=DECIMAL}, 
      #{supplierCode,jdbcType=VARCHAR}, #{supplierName,jdbcType=VARCHAR}, #{supplierAddr1,jdbcType=VARCHAR}, 
      #{supplierAddr2,jdbcType=VARCHAR}, #{supplierAddr3,jdbcType=VARCHAR}, #{supplierAddr4,jdbcType=VARCHAR}, 
      #{supplierCity,jdbcType=VARCHAR}, #{supplierState,jdbcType=VARCHAR}, #{supplierCtryCode,jdbcType=CHAR}, 
      #{supplierPostalCode,jdbcType=VARCHAR}, #{storeCode,jdbcType=VARCHAR}, #{storeName,jdbcType=VARCHAR}, 
      #{storeAddr1,jdbcType=VARCHAR}, #{storeAddr2,jdbcType=VARCHAR}, #{storeAddr3,jdbcType=VARCHAR}, 
      #{storeAddr4,jdbcType=CHAR}, #{storeCity,jdbcType=VARCHAR}, #{storeState,jdbcType=VARCHAR}, 
      #{storeCtryCode,jdbcType=CHAR}, #{storePostalCode,jdbcType=VARCHAR}, #{totalCost,jdbcType=DECIMAL}, 
      #{totalVat,jdbcType=DECIMAL}, #{totalCostWithVat,jdbcType=DECIMAL}, #{vatRate,jdbcType=DECIMAL}, 
      #{reasonCode,jdbcType=VARCHAR}, #{reasonDesc,jdbcType=VARCHAR}, #{dnRemarks,jdbcType=VARCHAR}, 
      #{sentToSupplier,jdbcType=BIT}, #{markSentToSupplier,jdbcType=BIT}, #{dnStatus,jdbcType=CHAR}, 
      #{duplicate,jdbcType=BIT}, #{priceStatus,jdbcType=CHAR}, #{qtyStatus,jdbcType=CHAR}, 
      #{buyerStatus,jdbcType=CHAR}, #{dispute,jdbcType=BIT}, #{disputeBy,jdbcType=VARCHAR}, 
      #{disputeDate,jdbcType=TIMESTAMP}, #{exported,jdbcType=BIT}, #{exportedDate,jdbcType=TIMESTAMP}, #{closed,jdbcType=BIT}, 
      #{closedBy,jdbcType=VARCHAR}, #{closedDate,jdbcType=TIMESTAMP}, #{closedRemarks,jdbcType=VARCHAR},
      #{priceDisputed,jdbcType=BIT}, #{qtyDisputed,jdbcType=BIT})
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.pracbiz.b2bportal.core.holder.DnHeaderHolder" >
    update DN_HEADER
    <set >
      <if test="dnNo != null" >
        DN_NO = #{dnNo,jdbcType=VARCHAR},
      </if>
      <if test="docAction != null" >
        DOC_ACTION = #{docAction,jdbcType=CHAR},
      </if>
      <if test="actionDate != null" >
        ACTION_DATE = #{actionDate,jdbcType=TIMESTAMP},
      </if>
      <if test="dnType != null" >
        DN_TYPE = #{dnType,jdbcType=VARCHAR},
      </if>
      <if test="dnTypeDesc != null" >
        DN_TYPE_DESC = #{dnTypeDesc,jdbcType=VARCHAR},
      </if>
      <if test="dnDate != null" >
        DN_DATE = #{dnDate,jdbcType=DATE},
      </if>
      <if test="poNo != null" >
        PO_NO = #{poNo,jdbcType=VARCHAR},
      </if>
      <if test="poDate != null" >
        PO_DATE = #{poDate,jdbcType=DATE},
      </if>
      <if test="invNo != null" >
        INV_NO = #{invNo,jdbcType=VARCHAR},
      </if>
      <if test="invDate != null" >
        INV_DATE = #{invDate,jdbcType=DATE},
      </if>
      <if test="rtvNo != null" >
        RTV_NO = #{rtvNo,jdbcType=VARCHAR},
      </if>
      <if test="rtvDate != null" >
        RTV_DATE = #{rtvDate,jdbcType=DATE},
      </if>
      <if test="giNo != null" >
        GI_NO = #{giNo,jdbcType=VARCHAR},
      </if>
      <if test="giDate != null" >
        GI_DATE = #{giDate,jdbcType=DATE},
      </if>
      <if test="buyerOid != null" >
        BUYER_OID = #{buyerOid,jdbcType=DECIMAL},
      </if>
      <if test="buyerCode != null" >
        BUYER_CODE = #{buyerCode,jdbcType=VARCHAR},
      </if>
      <if test="buyerName != null" >
        BUYER_NAME = #{buyerName,jdbcType=VARCHAR},
      </if>
      <if test="buyerAddr1 != null" >
        BUYER_ADDR1 = #{buyerAddr1,jdbcType=VARCHAR},
      </if>
      <if test="buyerAddr2 != null" >
        BUYER_ADDR2 = #{buyerAddr2,jdbcType=VARCHAR},
      </if>
      <if test="buyerAddr3 != null" >
        BUYER_ADDR3 = #{buyerAddr3,jdbcType=VARCHAR},
      </if>
      <if test="buyerAddr4 != null" >
        BUYER_ADDR4 = #{buyerAddr4,jdbcType=VARCHAR},
      </if>
      <if test="buyerCity != null" >
        BUYER_CITY = #{buyerCity,jdbcType=VARCHAR},
      </if>
      <if test="buyerState != null" >
        BUYER_STATE = #{buyerState,jdbcType=VARCHAR},
      </if>
      <if test="buyerCtryCode != null" >
        BUYER_CTRY_CODE = #{buyerCtryCode,jdbcType=CHAR},
      </if>
      <if test="buyerPostalCode != null" >
        BUYER_POSTAL_CODE = #{buyerPostalCode,jdbcType=VARCHAR},
      </if>
      <if test="deptCode != null" >
        DEPT_CODE = #{deptCode,jdbcType=VARCHAR},
      </if>
      <if test="deptName != null" >
        DEPT_NAME = #{deptName,jdbcType=VARCHAR},
      </if>
      <if test="subDeptCode != null" >
        SUB_DEPT_CODE = #{subDeptCode,jdbcType=VARCHAR},
      </if>
      <if test="subDeptName != null" >
        SUB_DEPT_NAME = #{subDeptName,jdbcType=VARCHAR},
      </if>
      <if test="supplierOid != null" >
        SUPPLIER_OID = #{supplierOid,jdbcType=DECIMAL},
      </if>
      <if test="supplierCode != null" >
        SUPPLIER_CODE = #{supplierCode,jdbcType=VARCHAR},
      </if>
      <if test="supplierName != null" >
        SUPPLIER_NAME = #{supplierName,jdbcType=VARCHAR},
      </if>
      <if test="supplierAddr1 != null" >
        SUPPLIER_ADDR1 = #{supplierAddr1,jdbcType=VARCHAR},
      </if>
      <if test="supplierAddr2 != null" >
        SUPPLIER_ADDR2 = #{supplierAddr2,jdbcType=VARCHAR},
      </if>
      <if test="supplierAddr3 != null" >
        SUPPLIER_ADDR3 = #{supplierAddr3,jdbcType=VARCHAR},
      </if>
      <if test="supplierAddr4 != null" >
        SUPPLIER_ADDR4 = #{supplierAddr4,jdbcType=VARCHAR},
      </if>
      <if test="supplierCity != null" >
        SUPPLIER_CITY = #{supplierCity,jdbcType=VARCHAR},
      </if>
      <if test="supplierState != null" >
        SUPPLIER_STATE = #{supplierState,jdbcType=VARCHAR},
      </if>
      <if test="supplierCtryCode != null" >
        SUPPLIER_CTRY_CODE = #{supplierCtryCode,jdbcType=CHAR},
      </if>
      <if test="supplierPostalCode != null" >
        SUPPLIER_POSTAL_CODE = #{supplierPostalCode,jdbcType=VARCHAR},
      </if>
      <if test="storeCode != null" >
        STORE_CODE = #{storeCode,jdbcType=VARCHAR},
      </if>
      <if test="storeName != null" >
        STORE_NAME = #{storeName,jdbcType=VARCHAR},
      </if>
      <if test="storeAddr1 != null" >
        STORE_ADDR1 = #{storeAddr1,jdbcType=VARCHAR},
      </if>
      <if test="storeAddr2 != null" >
        STORE_ADDR2 = #{storeAddr2,jdbcType=VARCHAR},
      </if>
      <if test="storeAddr3 != null" >
        STORE_ADDR3 = #{storeAddr3,jdbcType=VARCHAR},
      </if>
      <if test="storeAddr4 != null" >
        STORE_ADDR4 = #{storeAddr4,jdbcType=CHAR},
      </if>
      <if test="storeCity != null" >
        STORE_CITY = #{storeCity,jdbcType=VARCHAR},
      </if>
      <if test="storeState != null" >
        STORE_STATE = #{storeState,jdbcType=VARCHAR},
      </if>
      <if test="storeCtryCode != null" >
        STORE_CTRY_CODE = #{storeCtryCode,jdbcType=CHAR},
      </if>
      <if test="storePostalCode != null" >
        STORE_POSTAL_CODE = #{storePostalCode,jdbcType=VARCHAR},
      </if>
      <if test="totalCost != null" >
        TOTAL_COST = #{totalCost,jdbcType=DECIMAL},
      </if>
      <if test="totalVat != null" >
        TOTAL_VAT = #{totalVat,jdbcType=DECIMAL},
      </if>
      <if test="totalCostWithVat != null" >
        TOTAL_COST_WITH_VAT = #{totalCostWithVat,jdbcType=DECIMAL},
      </if>
      <if test="vatRate != null" >
        VAT_RATE = #{vatRate,jdbcType=DECIMAL},
      </if>
      <if test="reasonCode != null" >
        REASON_CODE = #{reasonCode,jdbcType=VARCHAR},
      </if>
      <if test="reasonDesc != null" >
        REASON_DESC = #{reasonDesc,jdbcType=VARCHAR},
      </if>
      <if test="dnRemarks != null" >
        DN_REMARKS = #{dnRemarks,jdbcType=VARCHAR},
      </if>
      <if test="sentToSupplier != null" >
        SENT_TO_SUPPLIER = #{sentToSupplier,jdbcType=BIT},
      </if>
      <if test="markSentToSupplier != null" >
        MARK_SENT_TO_SUPPLIER = #{markSentToSupplier,jdbcType=BIT},
      </if>
      <if test="dnStatus != null" >
        CTRL_STATUS = #{dnStatus,jdbcType=CHAR},
      </if>
      <if test="duplicate != null" >
        DUPLICATE = #{duplicate,jdbcType=BIT},
      </if>
      <if test="priceStatus != null" >
        PRICE_STATUS = #{priceStatus,jdbcType=CHAR},
      </if>
      <if test="qtyStatus != null" >
        QTY_STATUS = #{qtyStatus,jdbcType=CHAR},
      </if>
      <if test="buyerStatus != null" >
        BUYER_STATUS = #{buyerStatus,jdbcType=CHAR},
      </if>
      <if test="dispute != null" >
        DISPUTE = #{dispute,jdbcType=BIT},
      </if>
      <if test="disputeBy != null" >
        DISPUTE_BY = #{disputeBy,jdbcType=VARCHAR},
      </if>
      <if test="disputeDate != null" >
        DISPUTE_DATE = #{disputeDate,jdbcType=TIMESTAMP},
      </if>
      <if test="exported != null" >
        EXPORTED = #{exported,jdbcType=BIT},
      </if>
      <if test="exportedDate != null" >
        EXPORTED_DATE = #{exportedDate,jdbcType=TIMESTAMP},
      </if>
      <if test="closed != null" >
        CLOSED = #{closed,jdbcType=BIT},
      </if>
      <if test="closedBy != null" >
        CLOSED_BY = #{closedBy,jdbcType=VARCHAR},
      </if>
      <if test="closedDate != null" >
        CLOSED_DATE = #{closedDate,jdbcType=TIMESTAMP},
      </if>
      <if test="closedRemarks != null" >
        CLOSED_REMARKS = #{closedRemarks,jdbcType=VARCHAR},
      </if>
      <if test="priceDisputed != null" >
        PRICE_DISPUTED = #{priceDisputed,jdbcType=BIT},
      </if>
      <if test="qtyDisputed != null" >
        QTY_DISPUTED = #{qtyDisputed,jdbcType=BIT},
      </if>
    </set>
    where DN_OID = #{dnOid,jdbcType=DECIMAL}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.pracbiz.b2bportal.core.holder.DnHeaderHolder" >
    update DN_HEADER
    set DN_NO = #{dnNo,jdbcType=VARCHAR},
      DOC_ACTION = #{docAction,jdbcType=CHAR},
      ACTION_DATE = #{actionDate,jdbcType=TIMESTAMP},
      DN_TYPE = #{dnType,jdbcType=VARCHAR},
      DN_TYPE_DESC = #{dnTypeDesc,jdbcType=VARCHAR},
      DN_DATE = #{dnDate,jdbcType=DATE},
      PO_NO = #{poNo,jdbcType=VARCHAR},
      PO_DATE = #{poDate,jdbcType=DATE},
      INV_NO = #{invNo,jdbcType=VARCHAR},
      INV_DATE = #{invDate,jdbcType=DATE},
      RTV_NO = #{rtvNo,jdbcType=VARCHAR},
      RTV_DATE = #{rtvDate,jdbcType=DATE},
      GI_NO = #{giNo,jdbcType=VARCHAR},
      GI_DATE = #{giDate,jdbcType=DATE},
      BUYER_OID = #{buyerOid,jdbcType=DECIMAL},
      BUYER_CODE = #{buyerCode,jdbcType=VARCHAR},
      BUYER_NAME = #{buyerName,jdbcType=VARCHAR},
      BUYER_ADDR1 = #{buyerAddr1,jdbcType=VARCHAR},
      BUYER_ADDR2 = #{buyerAddr2,jdbcType=VARCHAR},
      BUYER_ADDR3 = #{buyerAddr3,jdbcType=VARCHAR},
      BUYER_ADDR4 = #{buyerAddr4,jdbcType=VARCHAR},
      BUYER_CITY = #{buyerCity,jdbcType=VARCHAR},
      BUYER_STATE = #{buyerState,jdbcType=VARCHAR},
      BUYER_CTRY_CODE = #{buyerCtryCode,jdbcType=CHAR},
      BUYER_POSTAL_CODE = #{buyerPostalCode,jdbcType=VARCHAR},
      DEPT_CODE = #{deptCode,jdbcType=VARCHAR},
      DEPT_NAME = #{deptName,jdbcType=VARCHAR},
      SUB_DEPT_CODE = #{subDeptCode,jdbcType=VARCHAR},
      SUB_DEPT_NAME = #{subDeptName,jdbcType=VARCHAR},
      SUPPLIER_OID = #{supplierOid,jdbcType=DECIMAL},
      SUPPLIER_CODE = #{supplierCode,jdbcType=VARCHAR},
      SUPPLIER_NAME = #{supplierName,jdbcType=VARCHAR},
      SUPPLIER_ADDR1 = #{supplierAddr1,jdbcType=VARCHAR},
      SUPPLIER_ADDR2 = #{supplierAddr2,jdbcType=VARCHAR},
      SUPPLIER_ADDR3 = #{supplierAddr3,jdbcType=VARCHAR},
      SUPPLIER_ADDR4 = #{supplierAddr4,jdbcType=VARCHAR},
      SUPPLIER_CITY = #{supplierCity,jdbcType=VARCHAR},
      SUPPLIER_STATE = #{supplierState,jdbcType=VARCHAR},
      SUPPLIER_CTRY_CODE = #{supplierCtryCode,jdbcType=CHAR},
      SUPPLIER_POSTAL_CODE = #{supplierPostalCode,jdbcType=VARCHAR},
      STORE_CODE = #{storeCode,jdbcType=VARCHAR},
      STORE_NAME = #{storeName,jdbcType=VARCHAR},
      STORE_ADDR1 = #{storeAddr1,jdbcType=VARCHAR},
      STORE_ADDR2 = #{storeAddr2,jdbcType=VARCHAR},
      STORE_ADDR3 = #{storeAddr3,jdbcType=VARCHAR},
      STORE_ADDR4 = #{storeAddr4,jdbcType=CHAR},
      STORE_CITY = #{storeCity,jdbcType=VARCHAR},
      STORE_STATE = #{storeState,jdbcType=VARCHAR},
      STORE_CTRY_CODE = #{storeCtryCode,jdbcType=CHAR},
      STORE_POSTAL_CODE = #{storePostalCode,jdbcType=VARCHAR},
      TOTAL_COST = #{totalCost,jdbcType=DECIMAL},
      TOTAL_VAT = #{totalVat,jdbcType=DECIMAL},
      TOTAL_COST_WITH_VAT = #{totalCostWithVat,jdbcType=DECIMAL},
      VAT_RATE = #{vatRate,jdbcType=DECIMAL},
      REASON_CODE = #{reasonCode,jdbcType=VARCHAR},
      REASON_DESC = #{reasonDesc,jdbcType=VARCHAR},
      DN_REMARKS = #{dnRemarks,jdbcType=VARCHAR},
      SENT_TO_SUPPLIER = #{sentToSupplier,jdbcType=BIT},
      MARK_SENT_TO_SUPPLIER = #{markSentToSupplier,jdbcType=BIT},
      CTRL_STATUS = #{dnStatus,jdbcType=CHAR},
      DUPLICATE = #{duplicate,jdbcType=BIT},
      PRICE_STATUS = #{priceStatus,jdbcType=CHAR},
      QTY_STATUS = #{qtyStatus,jdbcType=CHAR},
      BUYER_STATUS = #{buyerStatus,jdbcType=CHAR},
      DISPUTE = #{dispute,jdbcType=BIT},
      DISPUTE_BY = #{disputeBy,jdbcType=VARCHAR},
      DISPUTE_DATE = #{disputeDate,jdbcType=TIMESTAMP},
      EXPORTED = #{exported,jdbcType=BIT},
      EXPORTED_DATE = #{exportedDate,jdbcType=TIMESTAMP},
      CLOSED = #{closed,jdbcType=BIT},
      CLOSED_BY = #{closedBy,jdbcType=VARCHAR},
      CLOSED_DATE = #{closedDate,jdbcType=TIMESTAMP},
      CLOSED_REMARKS = #{closedRemarks,jdbcType=VARCHAR},
      PRICE_DISPUTED = #{priceDisputed,jdbcType=BIT},
      QTY_DISPUTED = #{qtyDisputed,jdbcType=BIT}
    where DN_OID = #{dnOid,jdbcType=DECIMAL}
  </update>
  
  <select id="selectNoDisputeDnHeadersByBuyerAndBufferingDays" resultMap="BaseResultMap" parameterType="java.util.Map" >
    select <include refid="Base_Column_List" /> from DN_HEADER 
    where BUYER_OID = #{buyerOid, jdbcType=DECIMAL} and DISPUTE = false and EXPORTED = false
    and datediff(now(), ACTION_DATE) <![CDATA[>=]]> #{bufferingDays,jdbcType=INTEGER}
  </select>
  
  <select id="selectDisputedAndAuditUnfinishedRecord" resultMap="BaseResultMap" parameterType="java.util.Map" >
    select <include refid="Base_Column_List" /> from DN_HEADER 
    where CLOSED = false and DISPUTE = true and BUYER_STATUS = 'PENDING' 
    and BUYER_OID = #{buyerOid, jdbcType=DECIMAL}
    <if test="supplierOid != null" >
        and SUPPLIER_OID = #{supplierOid,jdbcType=DECIMAL}
    </if>
  </select>
  
  <select id="selectClosedDnRecordsBySupplierAndTimeRange" resultMap="BaseResultMap" parameterType="java.util.Map" >
    select <include refid="Base_Column_List" /> from DN_HEADER
    where CLOSED = true and SUPPLIER_OID = #{supplierOid, jdbcType=DECIMAL}
    <if test="begin != null">
        and CLOSED_DATE <![CDATA[>=]]> #{begin, jdbcType=TIMESTAMP}
    </if>
    <if test="end != null">
        and CLOSED_DATE <![CDATA[<=]]> #{end, jdbcType=TIMESTAMP}
    </if>
    AND BUYER_OID IN (SELECT B.BUYER_OID FROM BUYER B, BUSINESS_RULE BR, BUYER_RULE R WHERE BR.RULE_OID = R.RULE_OID
    AND B.BUYER_OID = R.BUYER_OID AND BR.FUNC_GROUP = 'Dn' AND BR.FUNC_ID = 'Backend' AND BR.RULE_ID = 'AutoGenDnFromGI')
  </select>
  
  <select id="selectResolutionRecordsByBuyer" resultMap="BaseResultMap" parameterType="java.util.Map" >
    select distinct DN_OID, DN_NO, DOC_ACTION, ACTION_DATE, DN_TYPE, DN_TYPE_DESC, DN_DATE, PO_NO, PO_DATE, 
    INV_NO, INV_DATE, RTV_NO, RTV_DATE, GI_NO, GI_DATE, BUYER_OID, BUYER_CODE, BUYER_NAME, 
    BUYER_ADDR1, BUYER_ADDR2, BUYER_ADDR3, BUYER_ADDR4, BUYER_CITY, BUYER_STATE, BUYER_CTRY_CODE, 
    BUYER_POSTAL_CODE, DEPT_CODE, DEPT_NAME, SUB_DEPT_CODE, SUB_DEPT_NAME, SUPPLIER_OID, 
    SUPPLIER_CODE, SUPPLIER_NAME, SUPPLIER_ADDR1, SUPPLIER_ADDR2, SUPPLIER_ADDR3, SUPPLIER_ADDR4, 
    SUPPLIER_CITY, SUPPLIER_STATE, SUPPLIER_CTRY_CODE, SUPPLIER_POSTAL_CODE, STORE_CODE, 
    STORE_NAME, STORE_ADDR1, STORE_ADDR2, STORE_ADDR3, STORE_ADDR4, STORE_CITY, STORE_STATE, 
    STORE_CTRY_CODE, STORE_POSTAL_CODE, TOTAL_COST, TOTAL_VAT, TOTAL_COST_WITH_VAT, VAT_RATE, 
    REASON_CODE, REASON_DESC, DN_REMARKS, SENT_TO_SUPPLIER, MARK_SENT_TO_SUPPLIER, CTRL_STATUS, 
    DUPLICATE, PRICE_STATUS, QTY_STATUS, BUYER_STATUS, DISPUTE, DISPUTE_BY, DISPUTE_DATE, 
    EXPORTED, EXPORTED_DATE, CLOSED_BY, CLOSED_DATE, CLOSED_REMARKS, PRICE_DISPUTED, QTY_DISPUTED, CLOSE_FLAG AS CLOSED from (
    select <include refid="Base_Column_List" />, TRUE AS CLOSE_FLAG from DN_HEADER DH
    where DH.BUYER_OID = #{buyerOid, jdbcType=DECIMAL} and  DH.CLOSED = true
    and datediff(#{reportDate,jdbcType=TIMESTAMP}, DH.CLOSED_DATE) = 0
    <if test="supplierCode != null" >
      AND DH.SUPPLIER_CODE like concat('%',#{supplierCode,jdbcType=VARCHAR},'%')
    </if>
    <if test="supplierName != null" >
      AND DH.SUPPLIER_NAME like concat('%',#{supplierName,jdbcType=VARCHAR},'%')
    </if>
    UNION
    select <include refid="Base_Column_List" />, FALSE AS CLOSE_FLAG from DN_HEADER DH
    where DH.BUYER_OID = #{buyerOid, jdbcType=DECIMAL} and  (DH.CLOSED_DATE IS NULL OR DATEDIFF(#{reportDate,jdbcType=TIMESTAMP}, CLOSED_DATE) <![CDATA[<]]> 0) and DH.BUYER_STATUS != 'PENDING'
    and DH.PRICE_DISPUTED = TRUE AND QTY_DISPUTED = TRUE
    AND DATEDIFF(#{reportDate,jdbcType=TIMESTAMP}, (SELECT IF (MAX(PRICE_STATUS_ACTION_DATE) > MAX(QTY_STATUS_ACTION_DATE), MAX(PRICE_STATUS_ACTION_DATE), MAX(QTY_STATUS_ACTION_DATE))
    FROM DN_DETAIL DD WHERE DH.DN_OID = DD.DN_OID)) >= 0
    <if test="supplierCode != null" >
      AND DH.SUPPLIER_CODE like concat('%',#{supplierCode,jdbcType=VARCHAR},'%')
    </if>
    <if test="supplierName != null" >
      AND DH.SUPPLIER_NAME like concat('%',#{supplierName,jdbcType=VARCHAR},'%')
    </if>
    UNION
    select <include refid="Base_Column_List" />, FALSE AS CLOSE_FLAG from DN_HEADER DH
    where DH.BUYER_OID = #{buyerOid, jdbcType=DECIMAL} and  (DH.CLOSED_DATE IS NULL OR DATEDIFF(#{reportDate,jdbcType=TIMESTAMP}, CLOSED_DATE) <![CDATA[<]]> 0) and DH.BUYER_STATUS != 'PENDING'
    and DH.PRICE_DISPUTED = TRUE AND QTY_DISPUTED = FALSE
    AND DATEDIFF(#{reportDate,jdbcType=TIMESTAMP}, (SELECT MAX(PRICE_STATUS_ACTION_DATE) FROM DN_DETAIL DD WHERE DH.DN_OID = DD.DN_OID)) >= 0
    <if test="supplierCode != null" >
      AND DH.SUPPLIER_CODE like concat('%',#{supplierCode,jdbcType=VARCHAR},'%')
    </if>
    <if test="supplierName != null" >
      AND DH.SUPPLIER_NAME like concat('%',#{supplierName,jdbcType=VARCHAR},'%')
    </if>
    UNION
    select <include refid="Base_Column_List" />, FALSE AS CLOSE_FLAG from DN_HEADER DH
    where DH.BUYER_OID = #{buyerOid, jdbcType=DECIMAL} and  (DH.CLOSED_DATE IS NULL OR DATEDIFF(#{reportDate,jdbcType=TIMESTAMP}, CLOSED_DATE) <![CDATA[<]]> 0) and DH.BUYER_STATUS != 'PENDING'
    and DH.PRICE_DISPUTED = FALSE AND QTY_DISPUTED = TRUE
    AND DATEDIFF(#{reportDate,jdbcType=TIMESTAMP}, (SELECT MAX(QTY_STATUS_ACTION_DATE) FROM DN_DETAIL DD WHERE DH.DN_OID = DD.DN_OID)) >= 0
    <if test="supplierCode != null" >
      AND DH.SUPPLIER_CODE like concat('%',#{supplierCode,jdbcType=VARCHAR},'%')
    </if>
    <if test="supplierName != null" >
      AND DH.SUPPLIER_NAME like concat('%',#{supplierName,jdbcType=VARCHAR},'%')
    </if>
    ) view1
  </select>
  
  <select id="selectOutstandingRecordsByBuyer" resultMap="BaseResultMap" parameterType="java.util.Map" >
    select <include refid="Base_Column_List" /> from DN_HEADER
    where CLOSED = false
    and DISPUTE = true and BUYER_STATUS = 'PENDING'
    <if test="buyerOid != null" >
      AND BUYER_OID = #{buyerOid,jdbcType=DECIMAL}
    </if>
    <if test="moreThanDays != null">
    	<if test="reportDate != null">
            AND DISPUTE_DATE <![CDATA[<=]]> DATE_SUB(#{reportDate,jdbcType=TIMESTAMP},INTERVAL #{moreThanDays,jdbcType=VARCHAR} day)
        </if>
        <if test="reportDate == null">
            AND DISPUTE_DATE <![CDATA[<=]]> DATE_SUB(NOW(),INTERVAL #{moreThanDays,jdbcType=VARCHAR} day)
        </if>
    </if>
    <if test="supplierCode != null" >
      AND SUPPLIER_CODE like concat('%',#{supplierCode,jdbcType=VARCHAR},'%')
    </if>
    <if test="supplierName != null" >
      AND SUPPLIER_NAME like concat('%',#{supplierName,jdbcType=VARCHAR},'%')
    </if>
  </select>
  
  <select id="selectEffectiveDnHeaderByOriginalFilename" resultMap="BaseResultMap" parameterType="java.util.Map" >
    select D.* from MSG_TRANSACTIONS M, DN_HEADER D WHERE M.DOC_OID=D.DN_OID 
    AND D.CTRL_STATUS != 'OUTDATED' AND M.ORIGINAL_FILENAME=#{originalFilename,jdbcType=VARCHAR};
  </select>
  
  <select id="selectAllRecordToExport" parameterType="com.pracbiz.b2bportal.core.holder.extension.DnSummaryHolder" resultMap="summaryResultMap">
		SELECT 
		<include refid="Grid_Column_List"/> 
		,if (D.CLOSED_BY = 'SYSTEM',D.CLOSED_BY,Concat((select USER_NAME from USER_PROFILE WHERE LOGIN_ID = D.CLOSED_BY), '(', D.CLOSED_BY, ')')) AS CLOSED_BY
		,(CASE WHEN 
		  (D.CLOSED = TRUE OR D.DISPUTE = TRUE OR VIEW2.STRING_VALUE is NULL OR VIEW2.STRING_VALUE = 0) THEN NULL 
		ELSE 
		  (CASE WHEN(VIEW2.STRING_VALUE-DATEDIFF(NOW(), ACTION_DATE)) <![CDATA[<=]]> 0 THEN NULL ELSE (VIEW2.STRING_VALUE-DATEDIFF(NOW(), ACTION_DATE)) END) 
	    END) DISPUTE_WINDOW,
	    (SELECT COUNT(*) FROM DN_DETAIL DD WHERE D.DN_OID = DD.DN_OID) AS DETAIL_COUNT,
	    (SELECT BR1.STRING_VALUE FROM BUYER_RULE BR1,BUSINESS_RULE BR2
        WHERE BR1.RULE_OID = BR2.RULE_OID AND BR2.FUNC_GROUP = 'Global' AND BR2.FUNC_ID='Global' 
        AND BR2.RULE_ID='RTVDnDisputeAlertWindow'
        AND BR1.BUYER_OID = VIEW2.BUYER_OID) AS ALERT_WINDOW
		FROM MSG_TRANSACTIONS M, DN_HEADER D,(SELECT B.BUYER_OID, VIEW1.STRING_VALUE FROM BUYER B LEFT JOIN 
		(SELECT B1.BUYER_OID, B1.STRING_VALUE FROM BUYER_RULE B1,BUSINESS_RULE B2
        WHERE B1.RULE_OID = B2.RULE_OID AND B2.FUNC_GROUP = 'Global' AND B2.FUNC_ID='Global' 
        AND B2.RULE_ID='RTVDnGeneratingJobBuffingDays') VIEW1
        ON B.BUYER_OID = VIEW1.BUYER_OID) VIEW2
		<!-- handle group constraint for buyer user. -->
        <if test="(currentUserType == 2 or currentUserType == 4) and visiable == true and fullGroupPriv == false">
	         <if test="listOid != null">
	         ,FAVOURITE_LIST_SUPPLIER FLS
	         </if>
	         <if test="listOid == null">
	         ,GROUP_SUPPLIER GS 
	         </if>
	    </if>
        <!-- handle group constraint for supplier user. -->
        <if test="(currentUserType == 3 or currentUserType == 5) and visiable == true and currentUserGroupOid != null and fullGroupPriv == false">
            ,GROUP_TRADING_PARTNER GTP, TRADING_PARTNER TP
        </if>
		<!-- handle supplier set --> 
		<if test="setOid != null and validSupplierSet == true ">
			, SUPPLIER S
		</if>
		WHERE M.DOC_OID = D.DN_OID AND D.BUYER_OID = VIEW2.BUYER_OID
		<if test="dnDateFrom != null">
			<![CDATA[
			AND D.DN_DATE >= #{dnDateFrom,jdbcType=TIMESTAMP}
			]]>
		</if>
		<if test="dnDateTo != null">
			<![CDATA[
			AND D.DN_DATE <= #{dnDateTo,jdbcType=TIMESTAMP}
			]]>
		</if>
		<if test="sentDateFrom != null">
			<![CDATA[
			AND M.SENT_DATE >= #{sentDateFrom,jdbcType=TIMESTAMP}
			]]>
		</if>
		<if test="sentDateTo != null">
			<![CDATA[
			AND M.SENT_DATE <= #{sentDateTo,jdbcType=TIMESTAMP}
			]]>
		</if>
		<if test="receivedDateFrom != null">
			<![CDATA[
			AND M.CREATE_DATE >= #{receivedDateFrom,jdbcType=TIMESTAMP}
			 ]]>
		</if>
		<if test="receivedDateTo != null">
			<![CDATA[
			AND M.CREATE_DATE <= #{receivedDateTo,jdbcType=TIMESTAMP}
			]]>
		</if>
		<if test="dnType != null" >
			AND D.DN_TYPE = #{dnType,jdbcType=VARCHAR}
		</if>
		<if test="poNo != null">
			AND D.PO_NO like concat('%',#{poNo,jdbcType=VARCHAR},'%')
		</if>
		<if test="poDateFrom != null">
			<![CDATA[
			AND D.PO_DATE >= #{poDateFrom,jdbcType=TIMESTAMP}
			 ]]>
		</if>
		<if test="poDateTo != null">
			<![CDATA[
			AND D.PO_DATE <= #{poDateTo,jdbcType=TIMESTAMP}
			]]>
		</if>
		<if test="invNo != null">
			AND D.INV_NO like concat('%',#{invNo,jdbcType=VARCHAR},'%')
		</if>
		<if test="invDateFrom != null">
			<![CDATA[
			AND D.INV_DATE  >= #{invDateFrom,jdbcType=TIMESTAMP}
			]]>
		</if>
		<if test="invDateTo != null">
			<![CDATA[
			AND D.INV_DATE  <= #{invDateTo,jdbcType=TIMESTAMP}
			]]>
		</if>
		<if test="dnNo != null">
			AND D.DN_NO like concat('%',#{dnNo,jdbcType=VARCHAR},'%')
		</if>
		<if test="rtvNo != null">
            AND D.RTV_NO like concat('%',#{rtvNo,jdbcType=VARCHAR},'%')
        </if>
		<if test="storeCode != null">
            AND D.STORE_CODE = #{storeCode,jdbcType=VARCHAR}
        </if>
		<if test="readStatus != null" >
            AND M.READ_STATUS = #{readStatus,jdbcType=VARCHAR}
        </if>
		<if test="dnStatus != null" >
            AND D.CTRL_STATUS = #{dnStatus,jdbcType=VARCHAR}
        </if>
        <if test="duplicate != null" >
            AND D.DUPLICATE = #{duplicate,jdbcType=BIT}
        </if>
        <if test="priceStatus != null">
            AND D.PRICE_STATUS = #{priceStatus,jdbcType=CHAR}
        </if>
        <if test="qtyStatus != null">
            AND D.QTY_STATUS = #{qtyStatus,jdbcType=CHAR}
        </if>
        <if test="buyerStatus != null">
            AND D.BUYER_STATUS = #{buyerStatus,jdbcType=CHAR}
        </if>
        <if test="dispute != null">
            AND D.DISPUTE = #{dispute,jdbcType=BIT}
        </if>
        <if test="closed != null">
            AND D.CLOSED = #{closed,jdbcType=BIT}
        </if>
        <if test="priceDisputed != null">
            AND D.PRICE_DISPUTED = #{priceDisputed,jdbcType=BIT}
        </if>
        <if test="qtyDisputed != null">
            AND D.QTY_DISPUTED = #{qtyDisputed,jdbcType=BIT}
        </if>
        <!-- filer class and sub class. -->
	    <if test="(currentUserType == 2 or currentUserType == 4) and priceApprove == true and fullClassPriv == false">
	      AND EXISTS

			(SELECT 1 FROM DOC_SUBCLASS SUB, USER_SUBCLASS USUB, `SUBCLASS` SC
			WHERE D.DN_OID = SUB.DOC_OID
			AND SC.SUBCLASS_OID = USUB.SUBCLASS_OID
			AND SUB.SUBCLASS_CODE = SC.SUBCLASS_CODE
			AND SUB.AUDIT_FINISHED = FALSE
			AND SUB.CLASS_CODE IN (SELECT CLASS_CODE FROM `CLASS` WHERE CLASS_OID = SC.CLASS_OID AND BUYER_OID=D.BUYER_OID) 
			AND USUB.USER_OID = #{currentUserOid,jdbcType=DECIMAL}
			UNION
			SELECT 1
			FROM DOC_SUBCLASS DSC, USER_CLASS USC, `SUBCLASS` SC
			WHERE D.DN_OID = DSC.DOC_OID
			AND SC.CLASS_OID = USC.CLASS_OID
			AND DSC.CLASS_CODE IN (SELECT CLASS_CODE FROM CLASS WHERE USC.CLASS_OID = CLASS_OID AND BUYER_OID = D.BUYER_OID)
      		AND DSC.AUDIT_FINISHED = FALSE
			AND USC.USER_OID=#{currentUserOid,jdbcType=DECIMAL})
	    </if>
		<!-- handle group constraint for buyer user. -->
        <if test="(currentUserType == 2 or currentUserType == 4) and visiable == true and fullGroupPriv == false">
           <if test="listOid != null">
               AND FLS.LIST_OID = #{listOid,jdbcType=DECIMAL}
               AND D.SUPPLIER_OID = FLS.SUPPLIER_OID
           </if>
           <if test="listOid == null">
                AND GS.GROUP_OID = #{currentUserGroupOid,jdbcType=DECIMAL}
                AND D.SUPPLIER_OID = GS.SUPPLIER_OID
           </if>
        </if>
        <!-- handle group constraint for supplier user. -->
        <if test="(currentUserType == 3 or currentUserType == 5) and visiable == true and currentUserGroupOid != null and fullGroupPriv == false">
            AND GTP.GROUP_OID = #{currentUserGroupOid,jdbcType=DECIMAL}
            AND GTP.TP_OID = TP.TP_OID
            AND TP.BUYER_SUPPLIER_CODE = D.SUPPLIER_CODE
            AND TP.BUYER_OID = D.BUYER_OID
        </if>
        <if test="visiable == false">
           AND 1 = 2
        </if>
        <!-- current is buyer type user or store type user, add restrict by buyer store access -->
        <if test="(currentUserType == 2 or currentUserType == 4 or currentUserType == 6 or currentUserType == 7) and allStoreFlag == false">
          <if test="buyerStoreAccessList != null">
              AND (D.STORE_CODE IN
              <foreach collection="buyerStoreAccessList" index="index" item="item" open="(" separator="," close=")">
                  #{item}
              </foreach>
              OR D.STORE_CODE IS NULL)
          </if>
          <if test="buyerStoreAccessList == null">
              AND 1=2
          </if>
        </if>
        <if test="supplierFlag">
          AND SENT_TO_SUPPLIER = true
        </if>
        <if test="currentUserBuyerOid != null">
            AND (M.BUYER_OID = #{currentUserBuyerOid,jdbcType=DECIMAL} OR M.BUYER_OID IN 
            (SELECT AAC.COMPANY_OID FROM ALLOWED_ACCESS_COMPANY AAC WHERE AAC.USER_OID=#{currentUserOid,jdbcType=DECIMAL}))
        </if>
        <if test="currentUserSupplierOid != null and setOid == null and validSupplierSet == false">
            AND M.SUPPLIER_OID = #{currentUserSupplierOid,jdbcType=DECIMAL}
        </if>
        <if test="supplierOid != null and supplierOid != -1 and setOid == null and validSupplierSet == false">
            AND M.SUPPLIER_OID = #{supplierOid,jdbcType=DECIMAL}
        </if>
        <if test="buyerOid != null and buyerOid != -1">
            AND M.BUYER_OID = #{buyerOid,jdbcType=DECIMAL}
        </if>
        <if test="supplierCode != null">
            AND M.SUPPLIER_CODE like concat('%',#{supplierCode,jdbcType=VARCHAR},'%')
        </if>
		<if test="setOid != null and validSupplierSet == true ">
			AND S.SUPPLIER_OID = D.SUPPLIER_OID 
			AND S.SET_OID = #{setOid,jdbcType=DECIMAL} 
			<if test="supplierOid != null and supplierOid != -1">
				AND S.SUPPLIER_OID = #{supplierOid,jdbcType=DECIMAL}
			</if>
		</if>
        <if test="supplierName != null">
            AND M.SUPPLIER_NAME like concat('%',#{supplierName,jdbcType=VARCHAR},'%')
        </if>
        <if test="currentUserType == 6 or currentUserType == 7">
	    	AND D.DN_TYPE NOT IN ('CST_CR','CST_IOC')
	    </if>
	    <if test="pendingForClosing == true">
	    	AND D.CLOSED = false
	    	AND D.BUYER_STATUS IN ('ACCEPTED', 'REJECTED')
	    </if>
		<if test="sortField != null" >
			order by ${sortField} ${sortOrder}
		</if>
	</select>
</mapper>